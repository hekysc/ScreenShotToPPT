# ScreenShotToPPT

一个基于 PyQt5 的 Windows 窗口截图与 PPT 生成工具。

主要能力：
- 后台窗口截图：列出可见窗口并抓取画面（无需窗口置前）。
- 定时自动采集：按间隔循环截图。
- 智能去重：相似内容不重复保存，减少冗余。
- 预览体验：悬浮预览 + 主界面实时预览。
- 一键导出 PPT：自动生成 16:9 页面，按 10% 边距等比缩放居中。
- 便捷结果链接：导出后可直接点击打开文件或所在文件夹。
- 参数记忆：记住保存目录与截图间隔。

平台与版本：
- 操作系统：仅支持 Windows（依赖 pywin32）。
- Python：建议 3.9 及以上版本。

应用图标：主窗口图标已设置为 `icon/icon.jpg`。

## 安装

可选：先创建虚拟环境。

```bash
pip install -r requirements.txt
```

依赖列表：`PyQt5`, `Pillow`, `python-pptx`, `pywin32`。

## 运行

```bash
python main.py
```

## 使用说明

1. 启动应用后，顶部下拉框显示当前可截图的窗口（带缩略图）。
2. 可点击“刷新”更新窗口列表，鼠标悬停可查看较大预览。
3. 设置“截图间隔（秒）”。
4. 选择“截图保存文件夹”。
5. 点击“开始截图”，应用将按设定间隔抓取当前选择的窗口。
   - 若连续两次截图内容相似，则不会重复保存。
   - 主界面会显示“有效截图”计数与最新预览。
6. 点击“停止截图”结束循环。
7. 点击“生成PPT”，选择输出路径后生成 `.pptx` 文件。
   - 结果区域提供可点击链接：打开文件或所在文件夹。

截图命名：`<窗口标题>_<YYYYMMDD_HHMMSS>.png`（会清理非法字符）。

PPT 导出：16:9 页面，图片按最大 90% 画布边距等比缩放并居中摆放。

## 目录结构

- `main.py`：应用入口与 UI 逻辑（窗口选择、预览、导出入口等）。
- `capture.py`：窗口枚举与截图、相似度判断、占位图等。
- `ppt_generator.py`：根据图片列表生成 16:9 的 PowerPoint。
- `img_convertor.py`：生成列表图标、预览图、QPixmap 转换等。
- `ui_style.py`：统一控件样式（按钮、标签、预览浮层等）。
- `icon/icon.jpg`：应用图标。
- `requirements.txt`：依赖清单。

## 常见问题

- 无法列出窗口/截图为空：
  - 以管理员身份运行试试。
  - 某些特殊/权限窗口可能无法通过 GDI 抓取。
- 截图全黑或异常：
  - 与显卡加速/分层窗口有关，可尝试将目标窗口置前验证。
- 生成 PPT 失败：
  - 确认安装 `python-pptx`；路径不可包含无权限的目录。
- 字体报错（占位图）：
  - 未找到 `arial.ttf` 时会回退到默认字体，属正常。

## 打包（可选）

如需分发可考虑使用 PyInstaller（示例命令，需按需调整）：

```bash
pyinstaller -F -w -i icon/icon.ico main.py
```

> 如果只有 `jpg` 图标，可先转换为 `ico` 格式再用于打包图标。

## 许可

本仓库未附带开源许可协议，如需开源或二次分发，请先添加合适的 License。
